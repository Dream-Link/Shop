<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§¶‡•Å‡§ï‡§æ‡§® ‡§∞‡•á‡§ü ‡§Æ‡•à‡§®‡•á‡§ú‡§∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'media',
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Noto Sans Devanagari', sans-serif;
        }
        
        .alphabet-overlay {
            position: fixed;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 10px 0 0 10px;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .alphabet-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .alphabet-scroll {
            position: fixed;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .alphabet-scroll.show {
            opacity: 1;
            visibility: visible;
        }
        
        .long-press-menu {
            position: absolute;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            z-index: 100;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.2s ease;
        }
        
        .long-press-menu.show {
            opacity: 1;
            transform: scale(1);
        }
        
        @media (prefers-color-scheme: dark) {
            .long-press-menu {
                background: #374151;
                color: white;
            }
        }
        
        .item-card {
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
        }
        
        .variety-item {
            border-left: 3px solid #3b82f6;
            padding-left: 8px;
            margin: 4px 0;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 min-h-screen transition-colors duration-300">
    <div class="container mx-auto px-4 py-4 max-w-md relative">
        <!-- Header with Menu -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-4 mb-4 flex justify-between items-center transition-colors duration-300">
            <div>
                <h1 class="text-xl font-bold text-gray-800 dark:text-white">üè™ ‡§¶‡•Å‡§ï‡§æ‡§® ‡§∞‡•á‡§ü</h1>
                <p class="text-gray-600 dark:text-gray-300 text-xs">‡§ï‡•Å‡§≤ ‡§µ‡§∏‡•ç‡§§‡•Å‡§è‡§Ç: <span id="itemCount">0</span></p>
            </div>
            <div class="relative">
                <button onclick="toggleMenu()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition duration-200">
                    <svg class="w-6 h-6 text-gray-600 dark:text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"></path>
                    </svg>
                </button>
                <div id="menuDropdown" class="hidden absolute right-0 top-12 bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-600 w-48 z-50">
                    <button onclick="openAddModal()" class="w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center space-x-2 text-gray-800 dark:text-white">
                        <span>‚ûï</span>
                        <span>‡§®‡§à ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
                    </button>
                    <button onclick="clearAllItems()" class="w-full text-left px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center space-x-2 text-red-600 dark:text-red-400">
                        <span>üóëÔ∏è</span>
                        <span>‡§∏‡§≠‡•Ä ‡§π‡§ü‡§æ‡§è‡§Ç</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Search Bar -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-3 mb-4 transition-colors duration-300">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="‡§µ‡§∏‡•ç‡§§‡•Å ‡§ñ‡•ã‡§ú‡•á‡§Ç..." 
                       class="w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"
                       oninput="searchItems()" ontouchstart="showAlphabetScroll()" ontouchend="hideAlphabetScroll()">
                <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </div>
        </div>

        <!-- Items List -->
        <div class="space-y-3">
            <div id="itemsList">
                <!-- Items will be displayed here -->
            </div>
            <div id="emptyState" class="text-center py-12 text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 rounded-xl shadow-md transition-colors duration-300">
                <div class="text-4xl mb-2">üìù</div>
                <p class="font-medium">‡§ï‡•ã‡§à ‡§µ‡§∏‡•ç‡§§‡•Å ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä</p>
                <p class="text-sm">‡§ä‡§™‡§∞ ‡§Æ‡•á‡§®‡•ç‡§Ø‡•Ç ‡§∏‡•á ‡§®‡§à ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</p>
            </div>
            <div id="noResults" class="hidden text-center py-8 text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 rounded-xl shadow-md transition-colors duration-300">
                <div class="text-3xl mb-2">üîç</div>
                <p>‡§ï‡•ã‡§à ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</p>
            </div>
        </div>
    </div>

    <!-- Alphabet Scroll (Hidden by default) -->
    <div id="alphabetScroll" class="alphabet-scroll flex flex-col space-y-1">
        <!-- Alphabet buttons will be generated here -->
    </div>

    <!-- Alphabet Overlay -->
    <div id="alphabetOverlay" class="alphabet-overlay">
        <div id="currentLetter" class="text-2xl font-bold"></div>
    </div>

    <!-- Long Press Menu -->
    <div id="longPressMenu" class="long-press-menu hidden">
        <button onclick="editItemFromMenu()" class="w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center space-x-2 rounded-t-xl">
            <span>‚úèÔ∏è</span>
            <span>‡§∏‡§Ç‡§™‡§æ‡§¶‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç</span>
        </button>
        <button onclick="addVarietyFromMenu()" class="w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center space-x-2">
            <span>‚ûï</span>
            <span>‡§µ‡•à‡§∞‡§æ‡§Ø‡§ü‡•Ä ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span>
        </button>
        <button onclick="deleteItemFromMenu()" class="w-full px-4 py-3 text-left hover:bg-gray-100 dark:hover:bg-gray-600 flex items-center space-x-2 text-red-600 dark:text-red-400 rounded-b-xl">
            <span>üóëÔ∏è</span>
            <span>‡§π‡§ü‡§æ‡§è‡§Ç</span>
        </button>
    </div>

    <!-- Add Item Modal -->
    <div id="addModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-sm transition-colors duration-300">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">‡§®‡§à ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡§æ ‡§®‡§æ‡§Æ</label>
                    <input type="text" id="itemName" placeholder="‡§ú‡•à‡§∏‡•á: ‡§ö‡§æ‡§µ‡§≤, ‡§¶‡§æ‡§≤, ‡§ö‡•Ä‡§®‡•Ä..." 
                           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§µ‡•à‡§∞‡§æ‡§Ø‡§ü‡•Ä ‡§ï‡§æ ‡§®‡§æ‡§Æ (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï)</label>
                    <input type="text" id="varietyName" placeholder="‡§ú‡•à‡§∏‡•á: ‡§¨‡§æ‡§∏‡§Æ‡§§‡•Ä, ‡§∏‡•ã‡§®‡§æ ‡§Æ‡§∏‡•Ç‡§∞‡•Ä..." 
                           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400">
                </div>

                <!-- Multiple Rate Inputs -->
                <div id="rateInputs">
                    <div class="rate-input-group">
                        <div class="flex space-x-2">
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§∞‡•á‡§ü/‡§≠‡§æ‡§µ</label>
                                <input type="number" class="rate-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white" placeholder="50">
                            </div>
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§Ø‡•Ç‡§®‡§ø‡§ü</label>
                                <select class="unit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                                    <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã">‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã</option>
                                    <option value="‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ">‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                                    <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó">‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó</option>
                                    <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞">‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞</option>
                                    <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü">‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü</option>
                                    <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®">‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button onclick="addRateInput()" class="text-blue-600 dark:text-blue-400 text-sm hover:underline">+ ‡§î‡§∞ ‡§∞‡•á‡§ü ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                
                <div class="flex space-x-3 pt-2">
                    <button onclick="addItem()" 
                            class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        ‚ûï ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
                    </button>
                    <button onclick="closeAddModal()" 
                            class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        ‚ùå ‡§∞‡§¶‡•ç‡§¶
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-sm transition-colors duration-300">
            <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">‡§µ‡§∏‡•ç‡§§‡•Å ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡§æ ‡§®‡§æ‡§Æ</label>
                    <input type="text" id="editItemName" 
                           class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                </div>
                
                <div id="editVarietiesList">
                    <!-- Varieties will be shown here for editing -->
                </div>
                
                <div class="flex space-x-3 pt-2">
                    <button onclick="updateItem()" 
                            class="flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        ‚úÖ ‡§Ö‡§™‡§°‡•á‡§ü
                    </button>
                    <button onclick="closeEditModal()" 
                            class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200">
                        ‚ùå ‡§∞‡§¶‡•ç‡§¶
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let items = JSON.parse(localStorage.getItem('shopItems')) || [];
        let editingIndex = -1;
        let filteredItems = [...items];
        let longPressTimer;
        let currentLongPressItem = null;

        function saveToStorage() {
            localStorage.setItem('shopItems', JSON.stringify(items));
        }

        function toggleMenu() {
            const menu = document.getElementById('menuDropdown');
            menu.classList.toggle('hidden');
        }

        function showAlphabetScroll() {
            const alphabetScroll = document.getElementById('alphabetScroll');
            alphabetScroll.classList.add('show');
            generateAlphabet();
        }

        function hideAlphabetScroll() {
            setTimeout(() => {
                const alphabetScroll = document.getElementById('alphabetScroll');
                alphabetScroll.classList.remove('show');
            }, 2000);
        }

        function openAddModal() {
            document.getElementById('addModal').classList.remove('hidden');
            document.getElementById('addModal').classList.add('flex');
            document.getElementById('menuDropdown').classList.add('hidden');
        }

        function closeAddModal() {
            document.getElementById('addModal').classList.add('hidden');
            document.getElementById('addModal').classList.remove('flex');
            clearForm();
        }

        function addRateInput() {
            const rateInputs = document.getElementById('rateInputs');
            const newRateInput = document.createElement('div');
            newRateInput.className = 'rate-input-group mt-3';
            newRateInput.innerHTML = `
                <div class="flex space-x-2">
                    <div class="flex-1">
                        <input type="number" class="rate-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white" placeholder="‡§∞‡•á‡§ü">
                    </div>
                    <div class="flex-1">
                        <select class="unit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                            <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã">‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã</option>
                            <option value="‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ">‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                            <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó">‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó</option>
                            <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞">‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞</option>
                            <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü">‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü</option>
                            <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®">‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®</option>
                        </select>
                    </div>
                    <button type="button" onclick="removeRateInput(this)" class="px-2 py-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900 rounded">
                        ‚ùå
                    </button>
                </div>
            `;
            rateInputs.appendChild(newRateInput);
        }

        function removeRateInput(button) {
            button.closest('.rate-input-group').remove();
        }

        function addItem() {
            const name = document.getElementById('itemName').value.trim();
            const varietyName = document.getElementById('varietyName').value.trim();
            const rateInputs = document.querySelectorAll('.rate-input');
            const unitInputs = document.querySelectorAll('.unit-input');

            if (!name) {
                alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≠‡§∞‡•á‡§Ç!');
                return;
            }

            const rates = [];
            for (let i = 0; i < rateInputs.length; i++) {
                const rate = rateInputs[i].value.trim();
                const unit = unitInputs[i].value;
                if (rate) {
                    rates.push({
                        rate: parseFloat(rate),
                        unit: unit
                    });
                }
            }

            if (rates.length === 0) {
                alert('‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ ‡§è‡§ï ‡§∞‡•á‡§ü ‡§≠‡§∞‡•á‡§Ç!');
                return;
            }

            // Check if item already exists
            const existingItemIndex = items.findIndex(item => item.name.toLowerCase() === name.toLowerCase());
            
            if (existingItemIndex !== -1) {
                // Add variety to existing item
                const variety = {
                    name: varietyName || '‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø',
                    rates: rates,
                    timestamp: new Date().toLocaleString('hi-IN')
                };
                items[existingItemIndex].varieties.push(variety);
            } else {
                // Create new item
                const newItem = {
                    name: name,
                    varieties: [{
                        name: varietyName || '‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø',
                        rates: rates,
                        timestamp: new Date().toLocaleString('hi-IN')
                    }],
                    timestamp: new Date().toLocaleString('hi-IN')
                };
                items.push(newItem);
            }

            items.sort((a, b) => a.name.localeCompare(b.name, 'hi'));
            saveToStorage();
            filteredItems = [...items];
            displayItems();
            closeAddModal();
        }

        function clearForm() {
            document.getElementById('itemName').value = '';
            document.getElementById('varietyName').value = '';
            const rateInputs = document.getElementById('rateInputs');
            rateInputs.innerHTML = `
                <div class="rate-input-group">
                    <div class="flex space-x-2">
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§∞‡•á‡§ü/‡§≠‡§æ‡§µ</label>
                            <input type="number" class="rate-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white" placeholder="50">
                        </div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§Ø‡•Ç‡§®‡§ø‡§ü</label>
                            <select class="unit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                                <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã">‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã</option>
                                <option value="‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ">‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                                <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó">‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó</option>
                                <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞">‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞</option>
                                <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü">‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü</option>
                                <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®">‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®</option>
                            </select>
                        </div>
                    </div>
                </div>
            `;
        }

        function searchItems() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            
            if (searchTerm === '') {
                filteredItems = [...items];
            } else {
                filteredItems = items.filter(item => 
                    item.name.toLowerCase().includes(searchTerm) ||
                    item.varieties.some(variety => variety.name.toLowerCase().includes(searchTerm))
                );
            }
            
            displayItems();
        }

        function displayItems() {
            const itemsList = document.getElementById('itemsList');
            const emptyState = document.getElementById('emptyState');
            const noResults = document.getElementById('noResults');
            const itemCount = document.getElementById('itemCount');

            itemCount.textContent = items.length;

            if (items.length === 0) {
                itemsList.innerHTML = '';
                emptyState.style.display = 'block';
                noResults.style.display = 'none';
                return;
            }

            if (filteredItems.length === 0) {
                itemsList.innerHTML = '';
                emptyState.style.display = 'none';
                noResults.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            noResults.style.display = 'none';
            
            itemsList.innerHTML = filteredItems.map((item, index) => {
                const originalIndex = items.findIndex(originalItem => originalItem.name === item.name);
                
                return `
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-100 dark:border-gray-600 overflow-hidden transition-colors duration-300 item-card" 
                     data-item-index="${originalIndex}"
                     ontouchstart="startLongPress(event, ${originalIndex})" 
                     ontouchend="endLongPress()" 
                     onmousedown="startLongPress(event, ${originalIndex})" 
                     onmouseup="endLongPress()"
                     onmouseleave="endLongPress()">
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800 dark:text-white text-lg mb-2">${item.name}</h3>
                        <div class="space-y-2">
                            ${item.varieties.map(variety => `
                                <div class="variety-item">
                                    ${variety.name !== '‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø' ? `<div class="text-sm font-medium text-gray-600 dark:text-gray-300 mb-1">${variety.name}</div>` : ''}
                                    <div class="flex flex-wrap gap-2">
                                        ${variety.rates.map(rateInfo => `
                                            <span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 px-2 py-1 rounded-full text-sm font-medium">
                                                ‚Çπ${rateInfo.rate} ${rateInfo.unit}
                                            </span>
                                        `).join('')}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            }).join('');
        }

        function startLongPress(event, itemIndex) {
            event.preventDefault();
            currentLongPressItem = itemIndex;
            longPressTimer = setTimeout(() => {
                showLongPressMenu(event, itemIndex);
            }, 500);
        }

        function endLongPress() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
        }

        function showLongPressMenu(event, itemIndex) {
            const menu = document.getElementById('longPressMenu');
            const rect = event.target.closest('.item-card').getBoundingClientRect();
            
            menu.style.left = `${rect.left + 10}px`;
            menu.style.top = `${rect.top + 10}px`;
            menu.classList.remove('hidden');
            menu.classList.add('show');
            
            currentLongPressItem = itemIndex;
        }

        function hideLongPressMenu() {
            const menu = document.getElementById('longPressMenu');
            menu.classList.remove('show');
            setTimeout(() => {
                menu.classList.add('hidden');
            }, 200);
        }

        function editItemFromMenu() {
            if (currentLongPressItem !== null) {
                editItem(currentLongPressItem);
            }
            hideLongPressMenu();
        }

        function addVarietyFromMenu() {
            if (currentLongPressItem !== null) {
                document.getElementById('itemName').value = items[currentLongPressItem].name;
                openAddModal();
            }
            hideLongPressMenu();
        }

        function deleteItemFromMenu() {
            if (currentLongPressItem !== null) {
                deleteItem(currentLongPressItem);
            }
            hideLongPressMenu();
        }

        function generateAlphabet() {
            const alphabetScroll = document.getElementById('alphabetScroll');
            const hindiAlphabet = ['‡§Ö', '‡§Ü', '‡§á', '‡§à', '‡§â', '‡§ä', '‡§è', '‡§ê', '‡§ì', '‡§î', '‡§ï', '‡§ñ', '‡§ó', '‡§ò', '‡§ö', '‡§õ', '‡§ú', '‡§ù', '‡§ü', '‡§†', '‡§°', '‡§¢', '‡§§', '‡§•', '‡§¶', '‡§ß', '‡§®', '‡§™', '‡§´', '‡§¨', '‡§≠', '‡§Æ', '‡§Ø', '‡§∞', '‡§≤', '‡§µ', '‡§∂', '‡§∑', '‡§∏', '‡§π'];
            const englishAlphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            
            const availableLetters = new Set();
            items.forEach(item => {
                const firstChar = item.name.charAt(0).toUpperCase();
                availableLetters.add(firstChar);
            });

            const allLetters = [...hindiAlphabet, ...englishAlphabet];
            
            alphabetScroll.innerHTML = allLetters.map(letter => {
                const isAvailable = availableLetters.has(letter);
                return `
                    <button ontouchstart="showLetterOverlay('${letter}')" ontouchend="hideLetterOverlay()" onclick="scrollToLetter('${letter}')" 
                            class="w-6 h-6 text-xs font-medium rounded transition duration-200 ${
                                isAvailable 
                                    ? 'text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900' 
                                    : 'text-gray-300 dark:text-gray-600 cursor-not-allowed'
                            }"
                            ${!isAvailable ? 'disabled' : ''}>
                        ${letter}
                    </button>
                `;
            }).join('');
        }

        function showLetterOverlay(letter) {
            const overlay = document.getElementById('alphabetOverlay');
            const currentLetter = document.getElementById('currentLetter');
            currentLetter.textContent = letter;
            overlay.classList.add('show');
        }

        function hideLetterOverlay() {
            setTimeout(() => {
                const overlay = document.getElementById('alphabetOverlay');
                overlay.classList.remove('show');
            }, 100);
        }

        function scrollToLetter(letter) {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = letter;
            searchItems();
        }

        function editItem(index) {
            editingIndex = index;
            const item = items[index];
            
            document.getElementById('editItemName').value = item.name;
            
            const editVarietiesList = document.getElementById('editVarietiesList');
            editVarietiesList.innerHTML = item.varieties.map((variety, vIndex) => `
                <div class="border border-gray-200 dark:border-gray-600 rounded-lg p-3 mb-3">
                    <div class="mb-2">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">‡§µ‡•à‡§∞‡§æ‡§Ø‡§ü‡•Ä ‡§ï‡§æ ‡§®‡§æ‡§Æ</label>
                        <input type="text" value="${variety.name}" class="variety-name-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                    </div>
                    <div class="variety-rates" data-variety-index="${vIndex}">
                        ${variety.rates.map((rateInfo, rIndex) => `
                            <div class="flex space-x-2 mb-2">
                                <div class="flex-1">
                                    <input type="number" value="${rateInfo.rate}" class="rate-edit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                                </div>
                                <div class="flex-1">
                                    <select class="unit-edit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã" ${rateInfo.unit === '‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã' ? 'selected' : ''}>‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã</option>
                                        <option value="‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ" ${rateInfo.unit === '‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ' ? 'selected' : ''}>‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó" ${rateInfo.unit === '‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó' ? 'selected' : ''}>‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó</option>
                                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞" ${rateInfo.unit === '‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞' ? 'selected' : ''}>‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞</option>
                                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü" ${rateInfo.unit === '‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü' ? 'selected' : ''}>‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü</option>
                                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®" ${rateInfo.unit === '‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®' ? 'selected' : ''}>‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®</option>
                                    </select>
                                </div>
                                ${variety.rates.length > 1 ? `<button type="button" onclick="removeEditRate(this)" class="px-2 py-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900 rounded">‚ùå</button>` : ''}
                            </div>
                        `).join('')}
                    </div>
                    <button type="button" onclick="addEditRate(${vIndex})" class="text-blue-600 dark:text-blue-400 text-sm hover:underline">+ ‡§∞‡•á‡§ü ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
                </div>
            `).join('');
            
            document.getElementById('editModal').classList.remove('hidden');
            document.getElementById('editModal').classList.add('flex');
        }

        function addEditRate(varietyIndex) {
            const varietyRates = document.querySelector(`[data-variety-index="${varietyIndex}"]`);
            const newRateDiv = document.createElement('div');
            newRateDiv.className = 'flex space-x-2 mb-2';
            newRateDiv.innerHTML = `
                <div class="flex-1">
                    <input type="number" class="rate-edit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white" placeholder="‡§∞‡•á‡§ü">
                </div>
                <div class="flex-1">
                    <select class="unit-edit-input w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-800 dark:text-white">
                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã">‡§™‡•ç‡§∞‡§§‡§ø ‡§ï‡§ø‡§≤‡•ã</option>
                        <option value="‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ">‡§™‡•ç‡§∞‡§§‡§ø 100 ‡§ó‡•ç‡§∞‡§æ‡§Æ</option>
                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó">‡§™‡•ç‡§∞‡§§‡§ø ‡§®‡§ó</option>
                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞">‡§™‡•ç‡§∞‡§§‡§ø ‡§≤‡•Ä‡§ü‡§∞</option>
                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü">‡§™‡•ç‡§∞‡§§‡§ø ‡§™‡•à‡§ï‡•á‡§ü</option>
                        <option value="‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®">‡§™‡•ç‡§∞‡§§‡§ø ‡§¶‡§∞‡•ç‡§ú‡§®</option>
                    </select>
                </div>
                <button type="button" onclick="removeEditRate(this)" class="px-2 py-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900 rounded">‚ùå</button>
            `;
            varietyRates.appendChild(newRateDiv);
        }

        function removeEditRate(button) {
            button.closest('.flex').remove();
        }

        function updateItem() {
            const name = document.getElementById('editItemName').value.trim();
            
            if (!name) {
                alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§≠‡§∞‡•á‡§Ç!');
                return;
            }

            const varietyNameInputs = document.querySelectorAll('.variety-name-input');
            const varieties = [];

            varietyNameInputs.forEach((nameInput, vIndex) => {
                const varietyDiv = document.querySelector(`[data-variety-index="${vIndex}"]`);
                const rateInputs = varietyDiv.querySelectorAll('.rate-edit-input');
                const unitInputs = varietyDiv.querySelectorAll('.unit-edit-input');
                
                const rates = [];
                rateInputs.forEach((rateInput, rIndex) => {
                    const rate = rateInput.value.trim();
                    if (rate) {
                        rates.push({
                            rate: parseFloat(rate),
                            unit: unitInputs[rIndex].value
                        });
                    }
                });

                if (rates.length > 0) {
                    varieties.push({
                        name: nameInput.value.trim() || '‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø',
                        rates: rates,
                        timestamp: new Date().toLocaleString('hi-IN')
                    });
                }
            });

            if (varieties.length === 0) {
                alert('‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ ‡§è‡§ï ‡§µ‡•à‡§∞‡§æ‡§Ø‡§ü‡•Ä ‡§î‡§∞ ‡§∞‡•á‡§ü ‡§≠‡§∞‡•á‡§Ç!');
                return;
            }

            items[editingIndex] = {
                ...items[editingIndex],
                name: name,
                varieties: varieties,
                timestamp: new Date().toLocaleString('hi-IN')
            };

            items.sort((a, b) => a.name.localeCompare(b.name, 'hi'));
            saveToStorage();
            filteredItems = [...items];
            displayItems();
            closeEditModal();
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
            editingIndex = -1;
        }

        function deleteItem(index) {
            if (confirm('‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§µ‡§∏‡•ç‡§§‡•Å ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?')) {
                items.splice(index, 1);
                saveToStorage();
                filteredItems = [...items];
                displayItems();
            }
        }

        function clearAllItems() {
            if (confirm('‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§∏‡§≠‡•Ä ‡§µ‡§∏‡•ç‡§§‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§π‡§ü‡§æ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?')) {
                items = [];
                filteredItems = [];
                saveToStorage();
                displayItems();
                document.getElementById('menuDropdown').classList.add('hidden');
            }
        }

        // Close dropdowns and menus when clicking outside
        document.addEventListener('click', function(e) {
            const menu = document.getElementById('menuDropdown');
            const longPressMenu = document.getElementById('longPressMenu');
            
            if (!e.target.closest('#menuDropdown') && !e.target.closest('button[onclick="toggleMenu()"]')) {
                menu.classList.add('hidden');
            }
            
            if (!e.target.closest('#longPressMenu')) {
                hideLongPressMenu();
            }
        });

        // Close modals when clicking outside
        document.getElementById('addModal').addEventListener('click', function(e) {
            if (e.target === this) closeAddModal();
        });

        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) closeEditModal();
        });

        // Initialize the app
        items.sort((a, b) => a.name.localeCompare(b.name, 'hi'));
        filteredItems = [...items];
        displayItems();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96c7f6c0c1f24722',t:'MTc1NDc0OTk1Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
